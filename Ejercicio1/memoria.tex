\documentclass[11pt,a4paper]{article}
\usepackage[spanish,es-nodecimaldot]{babel}	% Utilizar español
\usepackage[utf8]{inputenc}					% Caracteres UTF-8
\usepackage{graphicx}						% Imagenes
\usepackage[hidelinks]{hyperref}			% Poner enlaces sin marcarlos en rojo
\usepackage{fancyhdr}						% Modificar encabezados y pies de pagina
\usepackage{float}							% Insertar figuras
\usepackage[textwidth=390pt]{geometry}		% Anchura de la pagina
\usepackage[nottoc]{tocbibind}				% Referencias (no incluir num pagina indice en Indice)
\usepackage{enumitem}						% Permitir enumerate con distintos simbolos
\usepackage[T1]{fontenc}					% Usar textsc en sections
\usepackage{amsmath}						% Símbolos matemáticos
\usepackage{algorithm}						% Environtment algorithm
\usepackage{algpseudocode}			% Pseudocodigo

% Comando para poner el nombre de la asignatura
\newcommand{\asignatura}{Simulación de Sistemas}
\newcommand{\autor}{Vladislav Nikolov Vasilev}
\newcommand{\titulo}{Problema 1}
\newcommand{\subtitulo}{Modelo de Montecarlo}

% Configuracion de encabezados y pies de pagina
\pagestyle{fancy}
\lhead{\autor{}}
\rhead{\asignatura{}}
\lfoot{Grado en Ingeniería Informática}
\cfoot{}
\rfoot{\thepage}
\renewcommand{\headrulewidth}{0.4pt}		% Linea cabeza de pagina
\renewcommand{\footrulewidth}{0.4pt}		% Linea pie de pagina

\begin{document}
\pagenumbering{gobble}

% Pagina de titulo
\begin{titlepage}

\begin{minipage}{\textwidth}

\centering

\includegraphics[scale=0.5]{img/ugr.png}\\

\textsc{\Large \asignatura{}\\[0.2cm]}
\textsc{GRADO EN INGENIERÍA INFORMÁTICA}\\[1cm]

\noindent\rule[-1ex]{\textwidth}{1pt}\\[1.5ex]
\textsc{{\Huge \titulo\\[0.5ex]}}
\textsc{{\Large \subtitulo\\}}
\noindent\rule[-1ex]{\textwidth}{2pt}\\[3.5ex]

\end{minipage}

\vspace{0.5cm}

\begin{minipage}{\textwidth}

\centering

\textbf{Autor}\\ {\autor{}}\\[2.5ex]
\textbf{Rama}\\ {Computación y Sistemas Inteligentes}\\[2.5ex]
\vspace{0.3cm}

\includegraphics[scale=0.3]{img/etsiit.jpeg}

\vspace{0.7cm}
\textsc{Escuela Técnica Superior de Ingenierías Informática y de Telecomunicación}\\
\vspace{1cm}
\textsc{Curso 2019-2020}
\end{minipage}
\end{titlepage}

\pagenumbering{arabic}
\tableofcontents
\thispagestyle{empty}				% No usar estilo en la pagina de indice

\newpage

\setlength{\parskip}{1em}

\section{\textsc{Descripción del problema}}

Una pequeña fábrica alimenticia se dedica a la producción de caramelos y huevos de Pascua.
Cada año, la fabrica recibe pedidos durante la primera semana de diciembre de huevos de
pascua Pascua de distintas confiterías. La demanda total de huevos varía año tras año, pero
suele seguir una distribución triangular con valor más probable $= 2600$ unidades, menor = $2000$
unidades y mayor $= 3000$ unidades.

Debido a razones estacionales, resulta más barato comprar el chocolate necesario para la
producción de los huevos durante el mes de agosto. Por este motivo, la empresa suele adquirir
una gran cantidad de chocolate durante este mes, y en caso de que cuando reciba los pedidos
sea necesario adquirir más chocolate, se obtiene la cantidad adicional necesaria para satisfacer
la demanda de forma exacta. Si se da el caso de que el chocolate comprado en agosto supera las
necesidades de producción, se dona la cantidad restante a comedores escolares. Se sabe además que:

\begin{itemize}[label=\textbullet]
	\item Cada huevo de Pascua emplea 250 gramos de chocolate.
	\item El precio del chocolate en agosto es de 1 euro por kilo.
	\item El precio del chocolate en diciembre es de $1.5$ euros por kilo.
	\item El precio de venta de los huevos de Pascua es de $0.60$ euros la unidad.
\end{itemize}

Nuestro objetivo es construir un modelo de simulación que ayude a la empresa a determinar
cuántos kilos de chocolate se deberían comprar en el mes de agosto para optimizar el nivel
de las ganancias.

\section{\textsc{Descripción del modelo construido}}

Para modelar el sistema anteriormente descrito se ha construido un \textbf{modelo de Montecarlo}.
Este modelo es el más adecuado al problema ya que no se tiene en cuenta el paso del tiempo.

Para poder construir el modelo necesitamos construir primero un generador de datos. Dicho generador
se utilizará para obtener la demanda de huevos de Pascua en el mes de diciembre. Para hacerlo, vamos
a utilizar el generador que se ha proporcionado en el enunciado del problema. Este es un generador
triangular con extremo inferior $a = 2000$, extremo superior $b = 3000$ y valor más probable
$c = 2600$. Como el funcionamiento ya es conocido, no vamos a entrar en más detalle.

Una vez que tengamos el generador, podemos construir el modelo de Montecarlo. Dicho modelo debe
ofrecer información sobre la demanda que puede satisfacer en el mes de diciembre con el chocolate
que se ha comprado en el mes de agosto, los kilos de chocolate que se han comprado para satisfacer
dicha demanda y el beneficio que se espera obtener (junto con su desviación típica). Vamos a ver primero
cómo se podría implementar el modelo y luego lo vamos a comentar brevemente:

\begin{algorithm}[H]
\caption{Modelo de Montecarlo.}
\begin{algorithmic}[1]
\State PRECIO\_HUEVO\_VENTA $\gets 0.6$
\State PRECIO\_HUEVO\_AGOS $\gets 1 \cdot 0.25$
\State PRECIO\_HUEVO\_DIC $\gets 1.5 \cdot 0.25$
\State $mejorSuministro \gets a$
\State $mejorGananciaMedia \gets -\infty$
\State $mejorDesviacion \gets 0$
\For{$s \gets a$ \textbf{to} $b$}
	\State $sum \gets 0$
	\State $sum2 \gets 0$
	\For{$i \gets 1$ \textbf{to} $numVeces$}
		\State $demanda \gets$ generademanda()
		\State $ganancia \gets demanda \cdot$ PRECIO\_HUEVO\_VENTA
		\If{$s \geq demanda$}
			\State $dineroPagado \gets s \cdot$ PRECIO\_HUEVO\_AGOS
		\Else
			\State $dineroPagado \gets s \cdot$ PRECIO\_HUEVO\_AGOS $+ (demanda - s) \cdot$ PRECIO\_HUEVO\_DIC
		\EndIf
		\State $ganancia \gets ganancia - dineroPagado$
		\State $sum \gets sum + ganancia$
		\State $sum2 \gets sum2 + ganancia^2$
	\EndFor
	\State $gananciaMediaEsperada \gets \frac{sum}{numVeces}$
	\State $\sigma \gets \sqrt{\frac{sum2 - numVeces \cdot gananciaMediaEsperada^2}{numVeces -1}}$
	
	\If{$gananciaMediaEsperada > mejorGananciaMedia$}
		\State $mejorSuministro \gets s$
		\State $mejorGananciaMedia \gets gananciaMediaEsperada$
		\State $mejorDesviacion \gets \sigma$
	\EndIf	
	\State Mostrar información por pantalla sobre la simulación $i-$ésima
\EndFor
\State Mostrar información sobre los mejores resultados
\end{algorithmic}
\end{algorithm}

Lo primero que se hace es fijar algunas constantes como podrían ser el precio del huevo de Pascua cuando
se vende (esta es la variable \texttt{PRECIO\_HUEVO\_VENTA}), el precio de producir un huevo
con el chocolate comprado en el mes de agosto (variable \texttt{PRECIO\_HUEVO\_AGOS}) y el precio de
producir un huevo durante el mes de diciembre (variable \texttt{PRECIO\_HUEVO\_DIC}). Para calcular
estas dos últimas variables se utiliza el precio del kilo de chocolate en el mes correspondiente
y se multiplica por la cantidad de kilos de chocolate que se necesitan para producir un huevo (recordemos
que dicho valor son 250 gramos, o lo que es lo mismo, $0.25$ kilos). Una vez que se han fijado dichas constantes
se fijan los valores iniciales de las variables que se quieren obtener y se procede a la simulación.

La variable \texttt{s} representa la demanda de huevos de Pascua que se puede satisfacer con el chocolate
comprado en agosto. Se prueba cada posible valor entero entre el extremo inferior y el superior de la distribución
triangular (2000 y 3000 respectivamente). Para cada uno de ellos se simula \texttt{numVeces} generando la demanda
con el generador triangular y calculando la ganancia que se obtiene en función de si la demanda es
superior o no a la que se puede satisfacer. Finalmente, se obtienen los resultados promedios y se actualizan
los mejores valores encontrados en el caso de que el beneficio que se haya obtenido es superior al mejor
encontrado. A la hora de mostrar los resultados, para obtener los kilos de chocolate que se han comprado
simplemente basta con multiplicar el valor de \texttt{s} por la cantidad de kilos de chocolate que forman un
huevo, valor que ya sabemos que es $0.25$.

Una vez que hemos explicado el funcionamiento general del modelo, vamos a ver la experimentación
realizada y los resultados que se han obtenido.

\section{\textsc{Experimentación y resultados}}



\end{document}

